<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>نظام إدارة السيارات</title>

<style>
body{
  margin:0;
  font-family: Tahoma, Arial;
  background:#fff;
}
header{
  text-align:center;
  border-bottom:3px solid #0a3cff;
  padding:15px;
}
header img{
  height:90px;
}
#datetime{
  font-size:22px;
  font-weight:bold;
  margin-top:10px;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
input,button{
  width:100%;
  padding:14px;
  margin:8px 0;
  font-size:20px;
}
button{
  background:#0a3cff;
  color:#fff;
  border:none;
  cursor:pointer;
}
button:hover{
  opacity:0.9;
}
.card{
  border:2px solid #0a3cff;
  border-radius:8px;
  margin:10px 0;
}
.card-header{
  padding:15px;
  font-size:22px;
  cursor:pointer;
  background:#f5f5f5;
}
.card-body{
  display:none;
  padding:15px;
  font-size:20px;
}
footer{
  text-align:center;
  padding:15px;
  border-top:2px solid #0a3cff;
  font-size:18px;
}
.hidden{display:none;}
</style>
</head>

<body>

<header>
  <img src="logo.png">
  <div id="datetime"></div>
</header>

<div class="container">

<!-- LOGIN -->
<div id="loginBox">
  <h2>تسجيل الدخول</h2>
  <input id="email" type="email" placeholder="البريد الإلكتروني">
  <input id="password" type="password" placeholder="كلمة المرور">
  <button onclick="login()">دخول</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">
  <h2>السيارات</h2>

  <button onclick="addCar()">إضافة سيارة</button>

  <div id="carsList"></div>
</div>

</div>

<footer>
Developed by Mohamed Saad ©
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCvrNKiue6lIvJVkgFXWwiYMEY3rWdmj4g",
  authDomain: "my-car123.firebaseapp.com",
  projectId: "my-car123",
  storageBucket: "my-car123.firebasestorage.app",
  messagingSenderId: "731889650556",
  appId: "1:731889650556:web:9c1fb521647131f48db2f9"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// LOGIN
window.login = function(){
  signInWithEmailAndPassword(
    auth,
    email.value,
    password.value
  ).then(()=>{
    alert("تم تسجيل الدخول بنجاح");
  }).catch(e=>{
    alert(e.message);
  });
}

// AUTH STATE
onAuthStateChanged(auth, user=>{
  if(user){
    loginBox.classList.add("hidden");
    dashboard.classList.remove("hidden");
    loadCars();
  }else{
    loginBox.classList.remove("hidden");
    dashboard.classList.add("hidden");
  }
});

// ADD CAR
window.addCar = async function(){
  await addDoc(collection(db,"cars"),{
    plate:"UAE-12345",
    owner:"مالك السيارة"
  });
}

// LOAD CARS
function loadCars(){
  onSnapshot(collection(db,"cars"), snap=>{
    carsList.innerHTML="";
    snap.forEach(doc=>{
      const d=doc.data();
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`
        <div class="card-header">${d.plate} - ${d.owner}</div>
        <div class="card-body">تفاصيل السيارة</div>
      `;
      card.querySelector(".card-header").onclick=()=>{
        const body=card.querySelector(".card-body");
        body.style.display=body.style.display=="block"?"none":"block";
      }
      carsList.appendChild(card);
    });
  });
}

// TIME
setInterval(()=>{
  const d=new Date();
  datetime.innerText=d.toLocaleString("en-GB");
},1000);
</script>

</body>
</html>